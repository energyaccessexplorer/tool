<script type="module">
  import {
    envs as user_envs,
    logged_in as user_logged_in,
  } from './user.js';

  let e;

  if (location.hostname.match(/localhost/))
    e = 'production';
  else {
    const subdomain = location.hostname.match(/^(.*).energyaccessexplorer.org/)[1];

    switch (subdomain) {
    case 'www':
      e = 'production';
      break;

    default:
      e = subdomain;
      break;
    }
  }

  const ee = [e].flat();
  const x = user_envs().find(t => ee.indexOf(t) > -1);

  const env = x || e;

  if (env !== 'production') {
    if (!user_logged_in()) window.location = '/login';
  }

  window.ENV = env;
</script>
